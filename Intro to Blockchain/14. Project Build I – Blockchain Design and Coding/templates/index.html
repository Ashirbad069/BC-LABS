{% extends "base.html" %}

{% block title %}BlockSim Dashboard{% endblock %}

{% block content %}
<div class="container">
    <!-- Hero Section -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card text-center p-4">
                <h1 class="display-4 fw-bold mb-3">
                    <i class="fas fa-cube me-3" style="color: var(--primary-color);"></i>
                    BlockSim Dashboard
                </h1>
                <p class="lead mb-4">Educational Blockchain Explorer & Simulator</p>
                
                <!-- Action Buttons -->
                <div class="row justify-content-center">
                    <div class="col-md-8">
                        <div class="d-flex gap-3 justify-content-center flex-wrap">
                            <a href="{{ url_for('add_transaction') }}" class="btn btn-primary">
                                <i class="fas fa-plus-circle me-2"></i>Add Transaction
                            </a>
                            
                            {% if stats.pending_transactions > 0 %}
                            <button type="button" class="btn btn-success" onclick="mineBlock()" id="mineButton">
                                <i class="fas fa-pickaxe me-2"></i>Mine Block
                                <span class="loading" id="mineLoading">
                                    <i class="fas fa-spinner fa-spin ms-2"></i>
                                </span>
                            </button>
                            
                            <div class="input-group" style="max-width: 200px;">
                                <input type="text" class="form-control" id="minerAddress" 
                                       placeholder="Miner Address" value="Web Miner">
                            </div>
                            {% endif %}
                            
                            <button type="button" class="btn btn-info" onclick="validateChain()">
                                <i class="fas fa-shield-alt me-2"></i>Validate Chain
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Blockchain Statistics -->
    <div class="row mb-4">
        <div class="col-12">
            <h2 class="mb-4"><i class="fas fa-chart-bar me-2"></i>Blockchain Statistics</h2>
        </div>
        
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="stat-card">
                <div class="stat-number" style="color: var(--primary-color);">
                    {{ stats.total_blocks }}
                </div>
                <div class="text-muted">
                    <i class="fas fa-cubes me-1"></i>Total Blocks
                </div>
            </div>
        </div>
        
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="stat-card">
                <div class="stat-number" style="color: var(--warning-color);">
                    {{ stats.pending_transactions }}
                </div>
                <div class="text-muted">
                    <i class="fas fa-clock me-1"></i>Pending Transactions
                </div>
            </div>
        </div>
        
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="stat-card">
                <div class="stat-number" style="color: var(--secondary-color);">
                    {{ stats.difficulty }}
                </div>
                <div class="text-muted">
                    <i class="fas fa-cog me-1"></i>Mining Difficulty
                </div>
            </div>
        </div>
        
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="stat-card">
                <div class="stat-number" style="color: {{ 'var(--success-color)' if stats.is_valid else 'var(--danger-color)' }};">
                    <i class="fas fa-{{ 'check-circle' if stats.is_valid else 'times-circle' }}"></i>
                </div>
                <div class="text-muted">
                    Chain {{ 'Valid' if stats.is_valid else 'Invalid' }}
                </div>
            </div>
        </div>
    </div>

    <!-- Latest Block Info -->
    {% if stats.latest_block_hash %}
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-cube me-2"></i>Latest Block
                    </h5>
                </div>
                <div class="card-body">
                    <div class="hash-display" onclick="copyToClipboard('{{ stats.latest_block_hash }}')">
                        <i class="fas fa-copy me-2" style="cursor: pointer;" title="Click to copy"></i>
                        {{ stats.latest_block_hash }}
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Account Balances -->
    {% if balances %}
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-wallet me-2"></i>Account Balances
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        {% for address, balance in balances.items() %}
                        <div class="col-md-6 col-lg-4 mb-3">
                            <div class="d-flex justify-content-between align-items-center p-3 rounded" 
                                 style="background: rgba(37, 99, 235, 0.1); border-left: 4px solid var(--primary-color);">
                                <div>
                                    <strong>{{ address }}</strong>
                                </div>
                                <div class="{{ 'balance-positive' if balance >= 0 else 'balance-negative' }}">
                                    {{ '+' if balance >= 0 else '' }}{{ balance }} coins
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Quick Actions -->
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-rocket me-2"></i>Quick Actions
                    </h5>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <a href="{{ url_for('view_blockchain') }}" class="btn btn-outline-primary">
                            <i class="fas fa-link me-2"></i>View Full Blockchain
                        </a>
                        <a href="{{ url_for('transactions') }}" class="btn btn-outline-warning">
                            <i class="fas fa-list me-2"></i>View Pending Transactions
                        </a>
                        <a href="{{ url_for('demo') }}" class="btn btn-outline-info">
                            <i class="fas fa-play me-2"></i>Load Demo Data
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-info-circle me-2"></i>Blockchain Info
                    </h5>
                </div>
                <div class="card-body">
                    <ul class="list-unstyled mb-0">
                        <li class="mb-2">
                            <i class="fas fa-shield-alt me-2 text-primary"></i>
                            <strong>Security:</strong> SHA256 Hashing
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-cogs me-2 text-success"></i>
                            <strong>Consensus:</strong> Proof of Work
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-network-wired me-2 text-info"></i>
                            <strong>Network:</strong> Single Node
                        </li>
                        <li class="mb-0">
                            <i class="fas fa-graduation-cap me-2 text-warning"></i>
                            <strong>Purpose:</strong> Educational
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Help Section -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-question-circle me-2"></i>How to Use BlockSim
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6><i class="fas fa-plus-circle me-2 text-primary"></i>Adding Transactions</h6>
                            <p class="text-muted mb-3">
                                Create new transactions between addresses. Transactions are added to a pending pool 
                                until they are mined into a block.
                            </p>
                            
                            <h6><i class="fas fa-pickaxe me-2 text-success"></i>Mining Blocks</h6>
                            <p class="text-muted mb-3">
                                Mine pending transactions into a new block. The mining process uses proof of work 
                                to find a valid hash.
                            </p>
                        </div>
                        <div class="col-md-6">
                            <h6><i class="fas fa-shield-alt me-2 text-info"></i>Validation</h6>
                            <p class="text-muted mb-3">
                                Verify the integrity of the entire blockchain. This checks that all hashes 
                                and links between blocks are correct.
                            </p>
                            
                            <h6><i class="fas fa-eye me-2 text-warning"></i>Exploring</h6>
                            <p class="text-muted mb-0">
                                View the complete blockchain, individual blocks, and transaction history 
                                to understand how everything connects.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
